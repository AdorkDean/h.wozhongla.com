/*! wozhongla 2015-01-23 */
define("wzlh5/1.0.0/wzlindex",["jquery/2.1.1/jquery","wzlh5/1.0.0/ac","handlebars/1.3.0/dist/cjs/handlebars","wzlh5/1.0.0/until","wzlh5/1.0.0/cp","wzlh5/1.0.0/ui","swiper/2.7.0/dist/idangerous.swiper"],function(require,exports,module){var $=require("jquery/2.1.1/jquery"),until=require("wzlh5/1.0.0/until"),action=require("wzlh5/1.0.0/ac"),wzlui=require("wzlh5/1.0.0/ui"),cp=require("wzlh5/1.0.0/cp"),Handlebars=require("handlebars/1.3.0/dist/cjs/handlebars").default,swiper=require("swiper/2.7.0/dist/idangerous.swiper"),pops=wzlui.containerMask,iscrollPop=wzlui.iscrollPop,dialog=wzlui.dialog,containerMask=wzlui.containerMask,dropdownMask=wzlui.dropdownMask,Y_Y=until.Y_Y,TZ_INFO=until.TZ_INFO,wzlindex=function(ac){function index(){$(".morelotterybtn").on("click",function(){$(".morelotterylist").slideToggle()});var arr2=["imgs/index/index_1.jpg","imgs/index/index_3.jpg"],myTemplate2=Handlebars.compile($("#table-template2").html());$(".swiper-container .swiper-wrapper").html(myTemplate2({data:arr2}));var mySwiper=new swiper(".swiper-container",{pagination:".pagination",loop:!0,grabCursor:!0,paginationClickable:!0});$(".arrow-left").on("click",function(e){e.preventDefault(),mySwiper.swipePrev()}),$(".arrow-right").on("click",function(e){e.preventDefault(),mySwiper.swipeNext()}),$(".wzl-nav-user").on("click",function(){location.href="views/ucenter.html"}),action.wzlindexWining({},function(re){for(var arr=[],i=0;i<re.length;i++){var str="";""==re[i].nickname&&(re[i].nickname=re[i].username),str="["+re[i].nickname+"]"+re[i].lotName+"喜中"+re[i].winAmount+"元",arr.push(str)}var myTemplate=Handlebars.compile($("#table-template1").html());$(".swiper-container2 .swiper-wrapper").html(myTemplate({data:arr}));new swiper(".swiper-container2",{paginationClickable:!0,mode:"vertical",autoplay:3e3,loop:!0})})}function index2(){function famatData(d){function doRender(info,list){var myTemplate=Handlebars.compile($("#table-template1").html());$("#indexFxb").html(myTemplate({info:info,list:list})).show(),$("#fxbli").show()}var info={},list=[];info.title=d[0].title,info.percent=d[0].matchInfo.split("|")[2],info.issue=d[0].matchInfo.split("|")[0].split(","),info.win=d[0].matchInfo.split("|")[1].split(","),action.jcMatchData({},function(re){function result(win,sp){var s="";switch(win){case"3":s="胜"+sp[0];break;case"1":s="平"+sp[1];break;case"0":s="负"+sp[2]}return s}if(!re.length)return void $("#fxbli,#indexFxb").hide();for(var i=0;i<re.length;i++)for(var j=0;j<info.issue.length;j++){var o={};info.issue[j]==re[i].matchNo&&(o.matchHome=re[i].matchHome,o.matchGuest=re[i].matchGuest,o.sp=result(info.win[j],re[i].sp),list.push(o))}list.length&&doRender(info,list)})}!function(){$(".swiper-wrapper").height("181");var list=[{src:"imgs/news/banner_1.png",href:"views/jc.html"},{src:"imgs/news/banner_2.jpg",href:"views/ucenter.html"}],myTemplate2=Handlebars.compile($("#table-template2").html());$(".swiper-container .swiper-wrapper").html(myTemplate2({data:list}));new swiper(".swiper-container",{pagination:".pagination",loop:!0,grabCursor:!0,paginationClickable:!0})}(),action.queryUserInfo({},function(re){"200"==re.resultCode&&"1"!=re.data.statusCode&&$(".header-r").html('<a href="views/ucenter.html"><i class="icon-user"></i></a>')}),action.wzlMobileHome({},function(re){re=eval("("+re+")"),famatData(re)})}function fxb(){function getGameByNo(fn){action.jcMatchData({},function(s){for(var list={},i=0;i<s.length;i++)list[s[i].matchNo]=s[i];fn&&fn(list)})}function famatData(re){function replaceGame(s){for(var t=s.split("|"),matchNos=t[0].split(","),sp=t[1].split(","),re=[],i=0;i<matchNos.length;i++)re.push({matchNo:matchNos[i],selected:sp[i]});return re}for(var list=[],i=0;i<re.length;i++){var o={};o.games=replaceGame(re[i].matchInfo),o.title=re[i].title,o.body=re[i].body,o.winTotal=re[i].winTotal,list.push(o)}return list}function getRendList(d,fn){function mergeData(gae){var t1={};t1.matchHome=gae.matchHome,t1.matchGuest=gae.matchGuest,t1.matchName=gae.matchName,t1.s=gae.sp[0],t1.p=gae.sp[1],t1.f=gae.sp[2],t1.issue=t1.matchNo=gae.matchNo.substring(gae.matchNo.length-4,gae.matchNo.length),t1.selected=replaceIndex(gae.selected),t1.sa=0==replaceIndex(gae.selected)?"active":"",t1.pa=1==replaceIndex(gae.selected)?"active":"",t1.fa=2==replaceIndex(gae.selected)?"active":"",t1.stopSaleTime=checkTime(gae.stopSaleTime.substring(8,12)),t1.endTime=gae.endTime,t1.no=gae.matchNo;var r=["胜","平","负"];return t1.r=r[replaceIndex(gae.selected)],t1.stopTime=gae.stopSaleTime,t1.comityBall=gae.comityBall,t1.wstr=gae.wstr,t1}function replaceIndex(d){var n=0;switch(d){case"3":n=0;break;case"1":n=1;break;case"0":n=2}return n}for(var i=0;i<d.length;i++)d[i].list=[mergeData(d[i].games[0]),mergeData(d[i].games[1])];$(".wzl-nav-bar").html('<span class="glyphicon glyphicon-wzl-back"></span>'+d[0].title||"");var myTemplate=Handlebars.compile($("#table-template1").html());$(".swiper-height").html(myTemplate({data:d})).height($(".fxb-container").height()+30);var mySwiper=new swiper(".swiper-container2",{pagination:".pagination2",loop:!0,grabCursor:!0,paginationClickable:!0,onTouchStart:function(){},onTouchEnd:function(){mySwiper.activeIndex%2?(U_SELECT=0,fn&&fn()):(U_SELECT=1,fn&&fn())}})}function inputEvent(fn){{var $fxb=$(".fxb-input"),$minus=$(".icon-minus"),$plus=$(".icon-plus");$("#money"),$("#backmoney")}$minus.unbind().bind("click",function(){var fxb=$fxb.val();fxb--,1>=fxb&&(fxb=1),$fxb.val(fxb),fn&&fn()}),$plus.unbind().bind("click",function(){var fxb=$fxb.val();fxb++,fxb>=9999&&(fxb=99),$fxb.val(fxb),fn&&fn()}),$fxb.unbind().bind("keyup",function(){var $val=$fxb.val();$val=$val.replace(/\D/g,""),$val=$val>20?20:$val,fn&&fn()})}function checkTime(h){var d=new Date;d.setHours(h.substring(0,2),h.substring(2,4),0,0);var m=d.getTime(),nm=m-9e5,d2=new Date;d2.setTime(nm);var t=d2.getHours()+":"+d2.getMinutes();return t}var untils=until,test=untils.getRequestParameter("v"),U_SELECT=0;action.wzlMobileHome({},function(re){re=eval("("+re+")");var slist=famatData(re);getGameByNo(function(s){function sendPost(d){function countM(d){for(var s=2,i=0;i<d.length;i++){var a=[d[i].s,d[i].p,d[i].f];s*=Number(a[d[i].selected])}return s}var b=1,price=countM(d.list).toFixed(2);$(".fxb-input").val(1),$("#money").html(2*b),$("#backmoney").attr("v",price).html(price),$("#fxbbuy").unbind().bind("click",function(){var bei=$(".fxb-input").val().trim()||1,data=getPosData(d.list,bei);data.lotoGson=JSON.stringify(data.lotoGson),action.jcTz(data,function(re){TZ_INFO($.parseJSON(re),function(){})})})}function getPosData(game,bei){function buynumberarrayToStr(){for(var s="",i=0;i<game.length;i++){var a=[];a.push(game[i].matchHome+"vs"+game[i].matchGuest),a.push(game[i].matchName),a.push("0:"+game[i].wstr+"-"+game[i].no+":["+game[i].r+"]:"+game[i].endTime),a.push(game[i].stopTime),a.push(game[i].comityBall),s+=a.join(",")+"/"}return s=s.slice(0,s.length-1),s+="|0-0"}var d={gameType:"320",format:"ajax",needPay:"",lotoGson:{}};d.needPay=2*bei;var lotoGson={gameType:"320",isStop:0,buyType:0,buyNumberArray:[{buyNumber:"悉尼FCvs阿德莱德联,澳超,0:周五002-201412265002:[胜]:20141226164500,20141226164500,0/切尔西vs西汉姆联,英超,0:周五003-201412265003:[平]:20141226204500,20141226204500,0|0-0",typeId:"02",seleId:"02",sum:2}],issueArray:[{issue:" ",multiple:1}],title:"",explain:"",secrecy:1,commision:0,commisiontype:0,splitAmount:0,buyAmount:0,floorsAmount:0,isUpload:0,qcdy:0,totalSum:2};return lotoGson.totalSum=2*bei,lotoGson.buyNumberArray=[{buyNumber:buynumberarrayToStr(),typeId:"02",seleId:"02",sum:2*bei}],d.lotoGson=lotoGson,d}for(var list=[],i=0;i<slist.length;i++){for(var games=slist[i].games,re=[],n=0;n<games.length;n++)if(s[games[n].matchNo]){var obj=$.extend(s[games[n].matchNo],games[n]);obj.wstr=s[games[n].matchNo].wstr,re.push(obj)}re&&re.length&&(slist[i].games=re,list.push(slist[i]))}if(0==list.length||"test"==test){var gamelist=[];for(var g in s){if(s[g].wstr=["","周一","周二","周三","周四","周五","周六","周日"][s[g].matchNo.substring(8,9)]+s[g].matchNo.substring(9),re.length>3)break;gamelist.push(s[g])}for(var i=0;i<slist.length;i++)slist[i].games=gamelist.slice(2*i,2+2*i),list.push(slist[i])}getRendList(list,function(){sendPost(list[U_SELECT])}),sendPost(list[0]),inputEvent(function(){var b=($("#money"),$(".fxb-input").val().trim()||1),$backmoney=$("#backmoney").attr("v");$("#money").html(2*b),$("#backmoney").html(($backmoney*b).toFixed(2))})})})}function matchDomain(){var host=location.host||location.hostname;"pt.wozhongla.com"==host&&$(".logo").addClass("ptlogo")}switch(ac){case"index":index();break;case"index2":index2();break;case"fxb":fxb()}matchDomain()};return{wzlindex:wzlindex}});