/*! wozhongla 2015-01-23 */
define("wzlh5/1.0.0/until",["jquery/2.1.1/jquery","handlebars/1.3.0/dist/cjs/handlebars","wzlh5/1.0.0/ac"],function(require){var $=require("jquery/2.1.1/jquery"),action=require("wzlh5/1.0.0/ac"),wzlui=require("wzlh5/1.0.0/ui"),Handlebars=require("handlebars/1.3.0/dist/cjs/handlebars").default,dialog=(wzlui.containerMask,wzlui.iscrollPop,wzlui.dialog),RULES=(wzlui.containerMask,wzlui.dropdownMask,{MOBILE:/^(?:13[0-9]|14[57]|15[0-35-9]|170|18[0-9])\d{8}$/,EMAIL:/^\w+(?:[\._+\-]\w+)*@\w+(?:\.\w+)+$/}),len=function(s){for(var l=0,a=s.split(""),i=0;i<a.length;i++)a[i].charCodeAt(0)<299?l++:l+=2;return l},getRequestParameter=function(a){var b=document.location.search||document.location.hash;if(null==a)return b;if(b){b=b.substring(1).split("&");for(var c=0;c<b.length;c++)if(b[c].substring(0,b[c].indexOf("="))==a)return b[c].substring(b[c].indexOf("=")+1)}return""},_Base64=function(){function Base64(){var _keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";this.encode=function(input){var chr1,chr2,chr3,enc1,enc2,enc3,enc4,output="",i=0;for(input=_utf8_encode(input);i<input.length;)chr1=input.charCodeAt(i++),chr2=input.charCodeAt(i++),chr3=input.charCodeAt(i++),enc1=chr1>>2,enc2=(3&chr1)<<4|chr2>>4,enc3=(15&chr2)<<2|chr3>>6,enc4=63&chr3,isNaN(chr2)?enc3=enc4=64:isNaN(chr3)&&(enc4=64),output=output+_keyStr.charAt(enc1)+_keyStr.charAt(enc2)+_keyStr.charAt(enc3)+_keyStr.charAt(enc4);return output},this.decode=function(input){var chr1,chr2,chr3,enc1,enc2,enc3,enc4,output="",i=0;for(input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");i<input.length;)enc1=_keyStr.indexOf(input.charAt(i++)),enc2=_keyStr.indexOf(input.charAt(i++)),enc3=_keyStr.indexOf(input.charAt(i++)),enc4=_keyStr.indexOf(input.charAt(i++)),chr1=enc1<<2|enc2>>4,chr2=(15&enc2)<<4|enc3>>2,chr3=(3&enc3)<<6|enc4,output+=String.fromCharCode(chr1),64!=enc3&&(output+=String.fromCharCode(chr2)),64!=enc4&&(output+=String.fromCharCode(chr3));return output=_utf8_decode(output)},_utf8_encode=function(string){string=string.replace(/\r\n/g,"\n");for(var utftext="",n=0;n<string.length;n++){var c=string.charCodeAt(n);128>c?utftext+=String.fromCharCode(c):c>127&&2048>c?(utftext+=String.fromCharCode(c>>6|192),utftext+=String.fromCharCode(63&c|128)):(utftext+=String.fromCharCode(c>>12|224),utftext+=String.fromCharCode(c>>6&63|128),utftext+=String.fromCharCode(63&c|128))}return utftext},_utf8_decode=function(utftext){for(var string="",i=0,c=c1=c2=0;i<utftext.length;)c=utftext.charCodeAt(i),128>c?(string+=String.fromCharCode(c),i++):c>191&&224>c?(c2=utftext.charCodeAt(i+1),string+=String.fromCharCode((31&c)<<6|63&c2),i+=2):(c2=utftext.charCodeAt(i+1),c3=utftext.charCodeAt(i+2),string+=String.fromCharCode((15&c)<<12|(63&c2)<<6|63&c3),i+=3);return string}}return new Base64}(),shref={login:"/views/login.html",index:"/index.html",ucenter:"/views/ucenter.html",paycenter:"/views/paycenter.html",ssq:"/views/ssq.html",dlt:"/views/dlt.html",jc:"/views/jc.html",jx11x5:"/views/jx11x5.html",ahk3:"/views/ahk3.html",fc3d:"/views/fc3d.html",pl3:"/views/pl3.html",ssc:"/views/ssc.html",cqssc:"/views/cqssc.html",pl5:"/views/pl5.html",qxc:"/views/qxc.html",qlc:"/views/qlc.html",accountdetail:"/views/accountdetail.html",bettingdetail:"/views/bettingdetail.html",bettingRecord:"/views/bettingRecord.html",bettingZH:"/views/bettingZH.html",savingscard:"/views/savingscard.html"},ref=function(url,backurl){function matchflat(u){var s=u.substring(u.lastIndexOf("/")+1,u.lastIndexOf("."));return s}location.href=backurl?shref[url]+"?ref="+matchflat(backurl):url},searchRef=function(u){return function(){window.WzlRoot=location.hostname}(),window.WzlRoot+shref[u]};$.fn.extend({randombox:function(fn){var n,bClick=!1,$this=$(this),$ball=$this.parent().next(".ball-random-block");$this.unbind().bind("click",function(){var t=$this.parent().offset().top,h=$this.outerHeight(),r=$(window).width()-($this.offset().left+$this.outerWidth()+10);$ball.css({zIndex:1e3,top:t+h+10,right:r,position:"absolute"}),bClick?(bClick=!1,$ball.hide(),$this.addClass("icon-dropdown-trans").removeClass("icon-dropup-trans")):(bClick=!0,$ball.show(),$this.removeClass("icon-dropdown-trans").addClass("icon-dropup-trans")),$this.parent().next(".ball-random-block ").find("li").unbind("click"),$this.parent().next(".ball-random-block ").find("li").on("click",function(){$(this).parent().parent().hide(),n=$(this).children().attr("num"),$(this).parent().parent().prev(".ballcon-jx-se").find(".ballcon-js-n").text(n+"个"),$this.prev().attr("num",n),fn&&fn(n)})}),$this.prev().unbind().bind("click",function(){n=$(this).attr("num"),fn&&fn(n)})}}),$.extend({wzlmore:function(fn){$(".wzl-nav-more").click(function(){$(this);$(".drop-down-more").fadeToggle();var $d=$(".drop-down-more").find("ul").find("li");$d.unbind("click"),$d.click(function(){$(".drop-down-more").hide()}),fn&&fn($d)}),$("body").click(function(e){$(e.target).hasClass("icon-more")||$(".drop-down-more").hide()})},wzlhistory:function(type,fn){function fomatIssue(d,name){for(var arr=[],i=0;i<d.length;i++){var obj={};obj.issue=d[i].lotIssue,obj.redball=d[i].kjCode.split("+")[0],obj.blueball=d[i].kjCode.split("+")[1],arr.push(obj)}var myTemplate=Handlebars.compile($("#history-template").html());$("#"+name).append(myTemplate({data:arr})),$(".history-bar").undelegate(),$(".history-bar").delegate(".history-bar-dropdown","click",function(){var $this=$(this);$(".history-list").slideToggle(function(){$(".history-bar-dropdown").hasClass("icon-dropdown-gray")?$this.addClass("icon-dropup-gray").removeClass("icon-dropdown-gray"):$this.removeClass("icon-dropup-gray").addClass("icon-dropdown-gray")})})}function fomatIssue2(d,name){for(var arr=[],i=0;i<d.length;i++){var obj={};obj.issue=d[i].lotIssue,obj.ball=d[i].kjCode,arr.push(obj)}var myTemplate=Handlebars.compile($("#history-template").html());$("#"+name).append(myTemplate({data:arr})),$(".history-bar").undelegate(),$(".history-bar").delegate(".history-bar-dropdown","click",function(){var $this=$(this);$(".history-list").slideToggle(function(){$(".history-bar-dropdown").hasClass("icon-dropdown-gray")?$this.addClass("icon-dropup-gray").removeClass("icon-dropdown-gray"):$this.removeClass("icon-dropup-gray").addClass("icon-dropdown-gray")})})}function setIssue(d){function setCountDown(s){"ssc"==type?(s-=120,0>s&&(clearTimeout(timer),d.endTime=600,s=600,d.issue++,setIssue(d))):"cqssc"==type&&(s-=90,0>s&&(clearTimeout(timer),d.endTime=600,s=600,d.issue++,setIssue(d))),timer=setInterval(function(){s--,0==s&&(clearTimeout(timer),location.reload(),$(".history-bar .history-bar-dropdown").html("<span class='redballs'>已停止销售！</span>"));var v=formatSeconds(s);$(".history-bar .history-bar-dropdown").html(v)},1e3)}function formatSeconds(value){function pad(n){return 10>n?"0"+n:n}var theTime=parseInt(value),theTime1=0,theTime2=0;theTime>60&&(theTime1=parseInt(theTime/60),theTime=parseInt(theTime%60),theTime1>60&&(theTime2=parseInt(theTime1/60),theTime1=parseInt(theTime1%60)));var result="<span class='redballs'>"+pad(parseInt(theTime))+"</span>秒";return theTime1>0&&(result="<span class='redballs'>"+pad(parseInt(theTime1))+"</span>分"+result),theTime2>0&&(result="<span class='redballs'>"+pad(parseInt(theTime2))+"</span>时"+result),result}setCountDown(d.endTime);var timer=null;$(".history-bar").html(" <span>第"+d.issue+"期销售中</span><div class='pull-right history-bar-dropdown icon-dropdown-gray'> <span class='redballs'>00</span>时<span class='redballs'>00</span>分<span class='redballs'>00</span>秒</div>");var s=d.endTime;"ssc"==type?(s-=120,0>s&&d.issue++):"cqssc"==type&&(s-=90,0>s&&d.issue++),fn&&fn(d)}var lottery="";switch(type){case"ssq":lottery="SSQ",action.querySsq({pageno:1,pagesize:10},function(d){fomatIssue(d.lotolist,"ssq-history")});break;case"ssc":lottery="JXSSC";break;case"fc3d":lottery="FC3D",action.queryFc3d({pageno:1,pagesize:10},function(d){fomatIssue2(d.lotolist,"f3d-history")});break;case"pl3":lottery="PL3",action.querypl3({pageno:1,pagesize:10},function(d){fomatIssue2(d.lotolist,"pl3-history")});break;case"dlt":lottery="DLT",action.queryDlt({pageno:1,pagesize:10},function(d){fomatIssue(d.lotolist,"dlt-history")});break;case"cqssc":lottery="CQSSC";break;case"pl5":lottery="PL5",action.querypl5({pageno:1,pagesize:10},function(d){fomatIssue2(d.lotolist,"pl5-history")});break;case"qxc":lottery="QXC",action.queryqxc({pageno:1,pagesize:10},function(d){fomatIssue2(d.lotolist,"qxc-history")});break;case"qlc":lottery="QLC",action.queryqlc({pageno:1,pagesize:10},function(d){fomatIssue(d.lotolist,"qlc-history")});break;case"jx11x5":lottery="JX11X5"}action.getIssue({lottery:lottery},function(d){setIssue(d[0])})},yaoyiyao:function(fn){var n=0;if(window.DeviceMotionEvent){var speed=20,x=y=z=lastX=lastY=lastZ=0;window.addEventListener("devicemotion",function(){var acceleration=event.accelerationIncludingGravity;if(x=acceleration.x,y=acceleration.y,Math.abs(x-lastX)>speed||Math.abs(y-lastY)>speed){fn&&fn();var d=new Date,t=d.getTime();t-n>=3e3&&(fn&&fn(),n=t)}lastX=x,lastY=y},!1)}}});var Router,Y_Y=function(fn){function deviceMotionHandler(){var speed=15,x=y=z=lastX=lastY=lastZ=0,acceleration=event.accelerationIncludingGravity;if(x=acceleration.x,y=acceleration.y,Math.abs(x-lastX)>speed||Math.abs(y-lastY)>speed){var d=new Date,t=d.getTime();t-n>=1500&&(fn&&fn(),n=t)}lastX=x,lastY=y,_fn=!0}var n=0,_fn=!1;window.DeviceMotionEvent&&(window.removeEventListener("devicemotion",deviceMotionHandler,!1),window.addEventListener("devicemotion",deviceMotionHandler,!1)),$(".ball-yaoyiyao").unbind().bind("click",function(){fn&&fn()})},TZ_INFO=function(info,fn){function needLogin(){dialog({type:"tips",message:s,onConfirm:function(){ref("login",location.pathname)}})}function needCz(){dialog({type:"tips",message:s,onConfirm:function(){ref("paycenter",location.pathname)},onCancel:function(){}})}function needInfo(){dialog({type:"tips",message:s,onConfirm:function(){ref("ucenter",location.pathname)}})}function commenError(){dialog({type:"tips",message:s,onConfirm:function(){location.reload()}})}function success(){dialog({type:"tips",message:s,onConfirm:function(){fn&&fn(info)}})}var s="投注异常",code=Number(info.resultCode);switch(code){case 200:s="投注成功",success();break;case 300:s="投注失败",commenError();break;case 301:s="非法用户，投注信息已变更",commenError();break;case 302:s="重复提交",commenError();break;case 303:s="投注信息不完整",commenError();break;case 304:commenError();break;case 305:commenError();break;case 306:s="单场上传内容为空",commenError();break;case 307:s="投注期次未开售或已过期",commenError();break;case 308:s="解析票错误",commenError();break;case 309:s="用户未登录",needLogin();break;case 310:s="购票异常",commenError();break;case 311:s="用户信息不全，请补全。",needInfo();break;case 312:s="账户余额不足，充值请点击确认。",needCz();break;case 501:s="投注异常",dialog(s)}};Router=function(routes){function parseRouter(routes){for(var i in routes)"string"==typeof i&&"function"==typeof routes[i]&&ac.push({path:i,fn:routes[i]})}function parseHash(url){var u,ucache=url.replace(/^[^#]*/,"");return ucache[1]!=def.type?"":u=ucache.slice(2)}function checkHash(url){var hash=parseHash(url)||"index";$(ac).each(function(i,router){router.path==hash&&router.fn()})}var win=window,ac=[],def={type:"!"};routes&&"object"==typeof routes&&(parseRouter(routes),$(win).bind("hashchange",function(ev){{var originEvent=ev.originalEvent,newUrl=originEvent.newURL;originEvent.oldURL}checkHash(newUrl)}),routes.init(),checkHash(win.location.hash))};var Ls={set:function(name,value){var Days=3600,oDate=new Date;oDate.setDate(oDate.getDate()+24*Days*60*60*1e3),document.cookie=name+"="+encodeURIComponent(value)+";expires="+oDate},get:function(name){for(var arr=document.cookie.split("; "),i=0,len=arr.length;len>i;i++){var arr2=arr[i].split("=");if(arr2[0]==name)return decodeURIComponent(arr2[1])}},remove:function(name){Ls.set(name,null,-1)},clear:function(){for(var cookies=document.cookie.split(";"),i=0;i<cookies.length;i++){var cookie=cookies[i],position=cookie.indexOf("="),name=position>-1?cookie.substring(0,position):cookie;document.cookie=name+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT"}},each:function(fn){for(var key,n=localStorage.length,i=0,fn=fn||function(){};n>i&&(key=localStorage.key(i),fn.call(this,key,this.get(key))!==!1);i++)localStorage.length<n&&(n--,i--)}};return{RULES:RULES,len:len,Base64:_Base64,getRequestParameter:getRequestParameter,ref:ref,searchRef:searchRef,shref:shref,Router:Router,Ls:Ls,Y_Y:Y_Y,TZ_INFO:TZ_INFO}});