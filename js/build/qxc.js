/*! wozhongla 2015-01-23 */
define("wzlh5/1.0.0/qxc",["jquery/2.1.1/jquery","wzlh5/1.0.0/ac","handlebars/1.3.0/dist/cjs/handlebars","wzlh5/1.0.0/until","wzlh5/1.0.0/cp","wzlh5/1.0.0/ui"],function(require){function init(){function fomatYl(d){var allArr=d.split(",");for(i=8;17>=i;i++)$("#yla em").eq(i-8).text(allArr[i]);for(i=18;27>=i;i++)$("#ylb em").eq(i-18).text(allArr[i]);for(i=28;37>=i;i++)$("#ylc em").eq(i-28).text(allArr[i]);for(i=38;47>=i;i++)$("#yld em").eq(i-38).text(allArr[i]);for(i=48;57>=i;i++)$("#yle em").eq(i-48).text(allArr[i]);for(i=58;67>=i;i++)$("#ylf em").eq(i-58).text(allArr[i]);for(i=68;77>=i;i++)$("#ylj em").eq(i-68).text(allArr[i])}$(".wzl-nav-dropdown").click(function(){$("#wzl-dropdown a").click(function(){})}),$.wzlmore(function(d){$("."+$(d).attr("class")).on("click",function(){})}),$.wzlhistory("qxc",function(d){QXC_NOWQI=d.issue}),$(".jc-match-i").on("click",function(){$("#selectjc,#jc-match").slideToggle()}),action.queryUserInfo({},function(){}),action.yl("qxc",{},function(re){"200"==re.resultCode&&fomatYl(re.data)}),$(".ballcon-yilou").on("click",function(){$(".ballcon-right em").toggle()})}function qxcNumberSelect(containerId,total,before,multipleSelect){return cp.numberSelect({min:0,max:9,ispad:!1,numberSelectBefore:function(f){before&&before(f)},numberSelectAfter:function(){total()},numberUnSelectAfter:function(){total()},selectStyle:".red_balls",containerId:containerId,multipleSelect:!multipleSelect})}function index(){function total(){var pl5c=countPl5();if(0!=pl5c){var count=PlayTypeRule.count(pl5c),price=count*CPCONFIG.QXC.UNIT_PRICE;$(".ball-status-bar").removeClass("disabled").html("共"+count+"注,"+price+"元")}else $(".ball-status-bar").addClass("disabled").html("每位至少选择 1 个号码")}function countPl5(){var qxc1=qxc_1.getSelected(),qxc2=qxc_2.getSelected(),qxc3=qxc_3.getSelected(),qxc4=qxc_4.getSelected(),qxc5=qxc_5.getSelected(),qxc6=qxc_6.getSelected(),qxc7=qxc_7.getSelected(),dsType=PlayTypeRule.qxc_ds;if(!(qxc1&&qxc1.length&&qxc2&&qxc2.length&&qxc3&&qxc3.length&&qxc4&&qxc4.length&&qxc5&&qxc5.length&&qxc6&&qxc6.length&&qxc7&&qxc7.length))return!1;var type="qxc_fs";qxc1.length==dsType.groupdef[0].required&&qxc2.length==dsType.groupdef[1].required&&qxc3.length==dsType.groupdef[2].required&&qxc4.length==dsType.groupdef[3].required&&qxc5.length==dsType.groupdef[4].required&&qxc6.length==dsType.groupdef[5].required&&qxc7.length==dsType.groupdef[6].required&&(type="qxc_ds");var groups=[{dan:null,tuo:qxc1},{dan:null,tuo:qxc2},{dan:null,tuo:qxc3},{dan:null,tuo:qxc4},{dan:null,tuo:qxc5},{dan:null,tuo:qxc6},{dan:null,tuo:qxc7}];return{code:type,groups:groups}}$("#f3dcar,#carfixed").fadeOut(function(){$(".wzl-cartext").addClass("hidden"),$(".wzl-nav-dropdown").show(),$("#selectqxc").fadeIn()});var qxc_1=qxcNumberSelect("#selectqxc .qxc-1",total,function(){}),qxc_2=qxcNumberSelect("#selectqxc .qxc-2",total,function(){}),qxc_3=qxcNumberSelect("#selectqxc .qxc-3",total,function(){}),qxc_4=qxcNumberSelect("#selectqxc .qxc-4",total,function(){}),qxc_5=qxcNumberSelect("#selectqxc .qxc-5",total,function(){}),qxc_6=qxcNumberSelect("#selectqxc .qxc-6",total,function(){}),qxc_7=qxcNumberSelect("#selectqxc .qxc-7",total,function(){});$(".ball-status-bar").unbind().bind("click",function(){var qxcc=countPl5();if(qxcc!==!1){var count=PlayTypeRule.count(qxcc),price=count*CPCONFIG.QXC.UNIT_PRICE;if(price>=CPCONFIG.QXC.MAX_AMOUNT)return dialog("单注投注不能超过"+CPCONFIG.QXC.MAX_AMOUNT+"元"),!1;qxcc.QXC_ID=++CACHE_ID,QXC_CAR.push(qxcc),qxc_1.clear(),qxc_2.clear(),qxc_3.clear(),qxc_4.clear(),qxc_5.clear(),qxc_6.clear(),qxc_7.clear(),location.href="#!/car"}else dialog("每位至少选择<span class='wzl-text-warning'>1</span>个号码")}),Y_Y(function(){qxc_1.clear(),qxc_2.clear(),qxc_3.clear(),qxc_4.clear(),qxc_5.clear(),qxc_6.clear(),qxc_7.clear();var n1=cp.shuffle({min:0,max:9,count:1});qxc_1.clear().select(n1);var n1=cp.shuffle({min:0,max:9,count:1});qxc_2.clear().select(n1);var n1=cp.shuffle({min:0,max:9,count:1});qxc_3.clear().select(n1);var n1=cp.shuffle({min:0,max:9,count:1});qxc_4.clear().select(n1);var n1=cp.shuffle({min:0,max:9,count:1});qxc_5.clear().select(n1);var n1=cp.shuffle({min:0,max:9,count:1});qxc_6.clear().select(n1);var n1=cp.shuffle({min:0,max:9,count:1});qxc_7.clear().select(n1)}),$(".glyphicon.icon-trash").on("click",function(){qxc_1.clear(),qxc_2.clear(),qxc_3.clear(),qxc_4.clear(),qxc_5.clear(),qxc_6.clear(),qxc_7.clear(),total()})}function qxccar(){function countCar(){function strBtype(type,item,notext){var s="",_s="";return s+=item.groups[0].tuo.join(" ")+",",s+=item.groups[1].tuo.join(" ")+",",s+=item.groups[2].tuo.join(" ")+",",s+=item.groups[3].tuo.join(" ")+",",s+=item.groups[4].tuo.join(" ")+",",s+=item.groups[5].tuo.join(" ")+",",s+=item.groups[6].tuo.join(" "),_s+=item.groups[0].tuo.join(" ")+",",_s+=item.groups[1].tuo.join(" ")+",",_s+=item.groups[2].tuo.join(" ")+",",_s+=item.groups[3].tuo.join(" ")+",",_s+=item.groups[4].tuo.join(" ")+",",_s+=item.groups[5].tuo.join(" ")+",",_s+=item.groups[6].tuo.join(" "),notext?_s:s}function type(t){var r="";switch(t){case"qxc_fs":r="复式";break;case"qxc_ds":r="单式"}return r}function remove(id){for(var j=0;j<QXC_CAR.length;j++)QXC_CAR[j].QXC_ID==id&&QXC_CAR.splice(j,1)}function clear(){QXC_CAR=[],QXC_BEI=1,QXC_QI=1,QXC_ZJ=!1,QXC_ZJSTOP=!1}for(var total,r=[],car_count=0,car_price=0,i=0;i<QXC_CAR.length;i++){var ritem={};ritem.count=PlayTypeRule.count(QXC_CAR[i]),ritem.price=ritem.count*CPCONFIG.QXC.UNIT_PRICE,ritem.type=type(QXC_CAR[i].code),ritem.code=QXC_CAR[i].code,ritem.id=QXC_CAR[i].QXC_ID,car_count+=ritem.count,car_price+=ritem.price,ritem.redStr=strBtype(QXC_CAR[i].code,QXC_CAR[i]),ritem._redStr=strBtype(QXC_CAR[i].code,QXC_CAR[i],!0),r.push(ritem)}return total={bei:QXC_BEI,qi:QXC_QI,count:car_count,price:car_price*QXC_QI*QXC_BEI,zjstop:QXC_ZJSTOP,zj:QXC_ZJ},{list:r,count:car_count,price:car_price,clear:clear,remove:remove,total:total}}function renderCar(){if(QXC_CAR.length){$("#car-no-select").addClass("hidden");var result=countCar(),listTemplate=Handlebars.compile($("#ball-select-item").html());$("#ball-select-group").html(listTemplate({list:result.list}));var totalTemplate=Handlebars.compile($("#car-total-template").html());$("#car-total").html(totalTemplate(result.total)),$("#f3dcar .ball-select-remove").unbind().bind("click",function(){var $id=$(this).parent().data("id");result.remove($id),renderCar()}),$("#ssq_hm").unbind().bind("click",function(){dialog("合买暂未开放！")}),$("#ssq_buy").unbind().bind("click",function(){$(this).attr("disabled"),postBuy(function(re){"200"==re.resultCode&&(result.clear(),renderCar(),tzsuccess())})})}else{$("#ball-select-group").html(""),$("#car-no-select").removeClass("hidden");var result=countCar(),totalTemplate=Handlebars.compile($("#car-total-template").html());$("#car-total").html(totalTemplate(result.total)),$("#ssq_buy").addClass("disabled")}totalBoard(function(qi,bei,zjstop){QXC_BEI=bei,QXC_QI=qi,QXC_ZJSTOP=zjstop,renderCar()})}function totalBoard(fn){function syanc(){setTimeout(function(){$qiInput.val(qi),$beiInput.val(bei),fn&&fn(qi,bei,zjstop)},100)}var $qiInput=$("#ball-qc"),$beiInput=$("#ball-bei"),$zjInput=$("input#ball-zj"),$zjstopInput=$("input#ball-zjstop"),bei=$beiInput.val().trim(),qi=$qiInput.val().trim(),zj=$zjInput.prop("checked"),zjstop=$zjstopInput.prop("checked");$(".buy-bar-qcminus").unbind().bind("click",function(){qi--,qi=1>qi?1:qi,syanc()}),$(".buy-bar-qcplus").unbind().bind("click",function(){qi++,qi=qi>99?99:qi,syanc()}),$(".buy-bar-beiminus").unbind().bind("click",function(){bei--,bei=1>bei?1:bei,syanc()}),$(".buy-bar-beiplus").unbind().bind("click",function(){bei++,bei=bei>9999?9999:bei,syanc()}),$($qiInput).unbind().bind("keyup",function(){var $val=$($qiInput).val();$val=$val.replace(/\D/g,""),$val=$val>99?99:$val,1>$val&&($val=1),$(this).val($val),qi=Number($val),syanc()}),$($beiInput).unbind().bind("keyup",function(){var $val=$($beiInput).val();$val=$val.replace(/\D/g,""),$val=$val>9999?9999:$val,1>$val&&($val=1),$(this).val($val),bei=Number($val),syanc()}),$("input#ball-zjstop").unbind().bind("click",function(){var $checked=$(this).prop("checked");zjstop=$checked,syanc()}),$("input#ball-zj").unbind().bind("click",function(){var $checked=$(this).prop("checked");zj=$checked,syanc()})}function getOneQXC(){var qxc_1=cp.shuffle({min:0,max:9,count:1}),qxc_2=cp.shuffle({min:0,max:9,count:1}),qxc_3=cp.shuffle({min:0,max:9,count:1}),qxc_4=cp.shuffle({min:0,max:9,count:1}),qxc_5=cp.shuffle({min:0,max:9,padding:!1,count:1}),qxc_6=cp.shuffle({min:0,max:9,padding:!1,count:1}),qxc_7=cp.shuffle({min:0,max:9,padding:!1,count:1}),QXCc={code:"qxc_ds",groups:[{dan:null,tuo:qxc_1},{dan:null,tuo:qxc_2},{dan:null,tuo:qxc_3},{dan:null,tuo:qxc_4},{dan:null,tuo:qxc_5},{dan:null,tuo:qxc_6},{dan:null,tuo:qxc_7}]};return QXCc.QXC_ID=++CACHE_ID,QXCc}function tzsuccess(){$("#car,#pl5plays,#carfixed,#f3dcar,#buycarfixedbtn").hide(),$("#tzsuccess").show()}function userBuyData(){function mergeTZ(){if(!sscCar)return!1;var need={gameType:"110",isStop:"",buyType:"0",buyNumberArray:"",issueArray:[],title:"0",explain:"0",secrecy:"1",splitAmount:"0",isUpload:"0",projectid:"0",buyAmount:0,floorsAmount:"0",totalSum:"0",qcdy:"0",unoid:"0",commision:"0",commisiontype:"0"};return need.totalSum=Number(sscCar.total.price),need.isStop=sscCar.total.zjstop?1:0,need.buyNumberArray=buyArrayGenerator(sscCar.list),need.buyType=sscCar.total.qi>1?1:0,need.title=sscCar.total.qi>1?"七星彩"+QXC_NOWQI+"期追号方案":"七星彩"+QXC_NOWQI+"期追号方案",need}function buyArrayGenerator(list){function join(item){var dataTmp={buyNumber:"",typeId:"00",seleId:"01",sum:0};if(!item||!item.count)return!1;var rs=item._redStr;switch(dataTmp.buyNumber=rs,dataTmp.sum=item.price,dataTmp.num=item.count,dataTmp.multiple=sscCar.total.bei,item.code){case"qxc_fs":dataTmp.typeId="00",dataTmp.seleId="02";break;case"qxc_ds":dataTmp.typeId="00",dataTmp.seleId="01"}return dataTmp}var r=[];return $(list).each(function(index,item){if(item){var it=join(item);it&&r.push(it)}}),r}function getIssues(fn){function merge(list){var r=[];return $(list).each(function(index,item){item.issue>=QXC_NOWQI&&r.length<QXC_QI&&r.push({issue:item.issue,multiple:sscCar.total.bei})}),r}var r=[];action.getIssue({lottery:"QXC",issues:sscCar.total.qi||QXC_QI},function(re){r=merge(re),fn(r)})}var sscCar=countCar();if(!sscCar)return null;var d={gameType:"110",format:"ajax",needPay:"",lotoGson:{}};return d.needPay=sscCar.total.price,d.lotoGson=mergeTZ(),{d:d,getIssue:getIssues}}function postBuy(fn){var u=userBuyData();if(0==u)return dialog("购物车是空的！");var udata=u.d;dialog("loading","正在投注！"),u.getIssue(function(r){return r&&r.length?(udata.lotoGson.issueArray=r,udata.lotoGson=JSON.stringify(udata.lotoGson),void action.pl3Tz(udata,function(re){TZ_INFO($.parseJSON(re),fn)})):dialog("投注异常，请重试")})}$("#selectqxc").fadeOut(function(){$(".wzl-nav-dropdown,#f3d-history").hide(),$(".wzl-cartext").removeClass("hidden"),$("#f3dcar, #carfixed").fadeIn(),renderCar()}),$("#car-addhm").bind("click",function(){location.href="#!/dg"}),$("#car-addjx").unbind().bind("click",function(){var QXCc=getOneQXC();QXC_CAR.push(QXCc),renderCar()}),$(".glyphicon.icon-trash").on("click",function(){var s=countCar();s.clear(),renderCar()})}var $=require("jquery/2.1.1/jquery"),until=require("wzlh5/1.0.0/until"),action=require("wzlh5/1.0.0/ac"),wzlui=require("wzlh5/1.0.0/ui"),cp=require("wzlh5/1.0.0/cp"),Handlebars=require("handlebars/1.3.0/dist/cjs/handlebars").default,dialog=(wzlui.containerMask,wzlui.iscrollPop,wzlui.dialog),Y_Y=(wzlui.containerMask,wzlui.dropdownMask,until.Y_Y),TZ_INFO=until.TZ_INFO,Router=until.Router,routes={"/car":function(){qxccar()},"/dg":function(){index()},index:function(){index()},init:function(){init()}};Router(routes);var QXC_CAR=[],QXC_BEI=1,QXC_QI=1,QXC_ZJ=!1,QXC_ZJSTOP=!1,QXC_NOWQI=null,CACHE_ID=0,PlayTypeRule=cp.PlayTypeRule,CPCONFIG=cp.CONFIG});